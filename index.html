<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Monster Mix</title>
<link rel="icon" type="image/png" href="favicon.png">
<link rel="apple-touch-icon" href="appicon.png">
<link rel="manifest" href="manifest.json">
<style>
:root{--brand-blue:#0d47a1;--brand-black:#000;--bg:#f4f6f9;}
*{box-sizing:border-box}
body{margin:0;font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;background:var(--bg);color:#222;padding:18px;display:flex;align-items:center;justify-content:center;min-height:100vh}
.card{width:100%;max-width:520px;background:#fff;border-radius:12px;padding:18px;box-shadow:0 6px 18px rgba(0,0,0,0.12);}
.header{ text-align:center }
img.logo{ width:60%; max-width:260px; height:auto; display:block; margin:6px auto; }
h1{ margin:6px 0;color:var(--brand-blue); font-size:20px }
.form-row{ margin-bottom:12px; text-align:left }
label{ display:block; font-weight:600; margin-bottom:6px }
input[type=number], select, input[type=text]{ width:100%; padding:10px 12px; border-radius:8px; border:1px solid #d0d7de; font-size:16px }
.controls{ display:flex; gap:10px; align-items:center }
.checkbox-inline{ display:flex; align-items:center; gap:8px }
.small{ width:120px }
button.primary{ width:100%; background:var(--brand-blue); color:#fff; border:none; padding:12px;border-radius:8px; font-size:16px; cursor:pointer }
.output{ margin-top:14px }
table{ width:100%; border-collapse:collapse; margin-top:8px }
th,td{ text-align:left; padding:8px 6px; border-bottom:1px solid #eee }
th{ background:var(--brand-blue); color:#fff }
.total-row td{ color:var(--brand-blue); font-weight:700 }
.toggle-input{ margin-top:8px }
@media(max-width:420px){ img.logo{width:70%} }
.note{ font-size:13px; color:#666; margin-top:10px }
</style>
</head>
<body>
<div class="card">
  <div class="header">
    <img src="MonsterLogo.png" alt="Monster Mix" class="logo">
    <h1>Price Calculator</h1>
  </div>

  <div class="form-row">
    <label for="product">Product Type</label>
    <select id="product">
      <option value="135" selected>C25 or less — £135/m</option>
      <option value="140">C30 — £140/m</option>
      <option value="145">C35 — £145/m</option>
      <option value="150">C40 — £150/m</option>
    </select>
  </div>

  <div class="form-row">
    <label for="metres">Metres required</label>
    <input id="metres" type="number" min="0" step="0.1" placeholder="e.g. 3.5">
  </div>

  <div class="form-row checkbox-inline">
    <input id="includePump" type="checkbox">
    <label for="includePump" style="margin:0">Include Pump (£350)</label>
  </div>

  <div class="form-row checkbox-inline" style="margin-top:8px">
    <input id="customDeliveryToggle" type="checkbox">
    <label for="customDeliveryToggle" style="margin:0">Custom Delivery</label>
  </div>
  <div class="form-row toggle-input" id="customDeliveryInput" style="display:none">
    <label for="customDelivery">Enter custom delivery (£)</label>
    <input id="customDelivery" type="number" min="0" step="0.01" placeholder="e.g. 55.00">
  </div>

  <div class="form-row checkbox-inline" style="margin-top:8px">
    <input id="waitingToggle" type="checkbox">
    <label for="waitingToggle" style="margin:0">Add Waiting Time</label>
  </div>
  <div class="form-row toggle-input" id="waitingInput" style="display:none">
    <label for="waitingMinutes">Minutes on site</label>
    <div class="controls">
      <input id="waitingMinutes" type="number" min="0" step="1" placeholder="minutes">
      <div style="align-self:center; color:#666">minutes on site</div>
    </div>
  </div>

  <div class="form-row">
    <button class="primary" onclick="showPrice()">Calculate</button>
  </div>

  <div id="output" class="output"></div>
  <div class="note">Note: VAT is calculated at 20% on the subtotal (material + delivery + pump + waiting).</div>
</div>

<script>
document.getElementById('customDeliveryToggle').addEventListener('change', function(){
  document.getElementById('customDeliveryInput').style.display = this.checked ? 'block' : 'none';
});
document.getElementById('waitingToggle').addEventListener('change', function(){
  document.getElementById('waitingInput').style.display = this.checked ? 'block' : 'none';
});

function autoDelivery(metres, includePump){
  const m = metres;
  if (m <= 0) return 0;
  if (includePump){
    if (m <= 2) return 80;
    if (m <= 4) return 60;
    if (m <= 7) return 50;
    return 20;
  } else {
    if (m <= 2) return 90;
    if (m <= 4) return 80;
    if (m <= 7) return 60;
    return 40;
  }
}

function calcWaitingCharge(metres, minutes){
  if (!minutes || minutes <= 0) return 0;
  const m = metres;
  let threshold = m <= 3 ? 30 : 45;
  if (minutes <= threshold) return 0;
  let extra = minutes - threshold;
  let increments = Math.ceil(extra / 15);
  return increments * 25;
}

function showPrice(){
  const metres = parseFloat(document.getElementById('metres').value) || 0;
  const prodSel = document.getElementById('product');
  const rate = parseFloat(prodSel.value);
  const productName = prodSel.options[prodSel.selectedIndex].text;
  const includePump = document.getElementById('includePump').checked;
  const customOn = document.getElementById('customDeliveryToggle').checked;
  const customVal = parseFloat(document.getElementById('customDelivery').value) || 0;
  const waitingOn = document.getElementById('waitingToggle').checked;
  const waitingMinutes = parseInt(document.getElementById('waitingMinutes').value) || 0;

  const materialCost = metres * rate;
  let deliveryCost = autoDelivery(metres, includePump);
  if (customOn){
    deliveryCost = customVal;
  }
  const pumpCost = includePump ? 350 : 0;
  const waitingCost = waitingOn ? calcWaitingCharge(metres, waitingMinutes) : 0;

  const subtotal = materialCost + deliveryCost + pumpCost + waitingCost;
  const vat = subtotal * 0.20;
  const total = subtotal + vat;

  document.getElementById('output').innerHTML = `
    <table>
      <tr><th>Item</th><th>Cost</th></tr>
      <tr><td>Product</td><td>${productName}</td></tr>
      <tr><td>Metres</td><td>${metres.toFixed(1)} m</td></tr>
      <tr><td>Rate / metre</td><td>£${rate.toFixed(2)}</td></tr>
      <tr><td>Material Cost</td><td>£${materialCost.toFixed(2)}</td></tr>
      <tr><td>Delivery</td><td>£${deliveryCost.toFixed(2)}</td></tr>
      <tr><td>Pump</td><td>£${pumpCost.toFixed(2)}</td></tr>
      <tr><td>Waiting Time</td><td>£${waitingCost.toFixed(2)}</td></tr>
      <tr><td>Subtotal (before VAT)</td><td>£${subtotal.toFixed(2)}</td></tr>
      <tr><td>VAT (20%)</td><td>£${vat.toFixed(2)}</td></tr>
      <tr class="total-row"><td>Total</td><td>£${total.toFixed(2)}</td></tr>
    </table>
  `;
}
</script>
</body>
</html>
