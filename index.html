<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Monster Mix Calculator</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="favicon.png" type="image/png">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom, #004080 50%, #000000 50%);
      color: white;
      text-align: center;
      min-height: 100vh;
    }
    header {
      padding: 20px;
      font-size: 1.5em;
      font-weight: bold;
    }
    main {
      padding: 20px;
    }
    label, select, input {
      display: block;
      margin: 10px auto;
      padding: 10px;
      font-size: 1em;
      width: 80%;
      max-width: 300px;
    }
    button {
      margin: 15px auto;
      padding: 12px 24px;
      background: #004080;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1em;
    }
    button:hover {
      background: #0066cc;
    }
    .result {
      background: rgba(255,255,255,0.1);
      padding: 15px;
      border-radius: 10px;
      margin-top: 20px;
      max-width: 400px;
      margin-left: auto;
      margin-right: auto;
      text-align: left;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <header>Monster Mix Price Calculator</header>
  <main>
    <label for="product">Select Product:</label>
    <select id="product">
      <option value="135">C25 or less (£135)</option>
      <option value="140">C30 (£140)</option>
      <option value="145">C35 (£145)</option>
      <option value="150">C40 (£150)</option>
    </select>

    <label for="metres">Metres Required:</label>
    <input type="number" id="metres" min="1" step="0.1" placeholder="Enter metres">

    <label><input type="checkbox" id="pump"> Pump Required (+£350)</label>
    <label><input type="checkbox" id="customDelivery"> Custom Delivery Cost</label>
    <input type="number" id="customDeliveryValue" class="hidden" placeholder="Enter delivery cost">

    <label><input type="checkbox" id="waiting"> Add Waiting Time</label>
    <div id="waitingInput" class="hidden">
      <input type="number" id="waitingMinutes" placeholder="Enter minutes">
      <span>minutes on site</span>
    </div>

    <button onclick="calculate()">Calculate</button>

    <div id="results" class="result hidden"></div>
  </main>

  <script>
    const deliveryCosts = {
      normal: [
        { max: 2, cost: 90 },
        { max: 4, cost: 80 },
        { max: 7, cost: 60 },
        { max: 10, cost: 40 },
        { max: Infinity, cost: 40 }
      ],
      pump: [
        { max: 2, cost: 80 },
        { max: 4, cost: 60 },
        { max: 7, cost: 50 },
        { max: 10, cost: 20 },
        { max: Infinity, cost: 20 }
      ]
    };

    document.getElementById('customDelivery').addEventListener('change', function() {
      document.getElementById('customDeliveryValue').classList.toggle('hidden', !this.checked);
    });

    document.getElementById('waiting').addEventListener('change', function() {
      document.getElementById('waitingInput').classList.toggle('hidden', !this.checked);
    });

    function calculate() {
      const rate = parseFloat(document.getElementById('product').value);
      const metres = parseFloat(document.getElementById('metres').value);
      const pump = document.getElementById('pump').checked;
      const customDelivery = document.getElementById('customDelivery').checked;
      const customDeliveryValue = parseFloat(document.getElementById('customDeliveryValue').value) || 0;
      const waiting = document.getElementById('waiting').checked;
      const waitingMinutes = parseInt(document.getElementById('waitingMinutes').value) || 0;

      if (isNaN(metres) || metres <= 0) {
        alert("Please enter valid metres required.");
        return;
      }

      // Base material cost
      const materialCost = metres * rate;

      // Delivery cost
      let deliveryCost = 0;
      if (customDelivery) {
        deliveryCost = customDeliveryValue;
      } else {
        const costs = pump ? deliveryCosts.pump : deliveryCosts.normal;
        deliveryCost = costs.find(c => metres <= c.max).cost;
      }

      // Pump cost
      let pumpCost = pump ? 350 : 0;

      // Waiting cost
      let waitingCost = 0;
      if (waiting) {
        if (metres <= 3) {
          if (waitingMinutes > 30) {
            waitingCost = 25 + Math.floor((waitingMinutes - 30) / 15) * 25;
          }
        } else {
          if (waitingMinutes > 45) {
            waitingCost = 25 + Math.floor((waitingMinutes - 45) / 15) * 25;
          }
        }
      }

      const subtotal = materialCost + deliveryCost + pumpCost + waitingCost;
      const vat = subtotal * 0.2;
      const total = subtotal + vat;

      // Display results
      const resultsDiv = document.getElementById('results');
      resultsDiv.classList.remove('hidden');
      resultsDiv.innerHTML = `
        <p>Material Cost: £${materialCost.toFixed(2)}</p>
        <p>Delivery: £${deliveryCost.toFixed(2)}</p>
        ${pump ? `<p>Pump: £${pumpCost.toFixed(2)}</p>` : ""}
        ${waiting ? `<p>Waiting Time: £${waitingCost.toFixed(2)}</p>` : ""}
        <p>Subtotal: £${subtotal.toFixed(2)}</p>
        <p>VAT (20%): £${vat.toFixed(2)}</p>
        <p><strong>Total: £${total.toFixed(2)}</strong></p>
      `;
    }
  </script>
</body>
</html>
